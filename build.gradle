plugins {
    id 'java'
}

group = 'org.example'
version = '1.0-SNAPSHOT'

repositories {
    mavenCentral()
}

def testngVersion = "7.10.2"
def selenideVersion = "7.11.1"
def allureVersion = "2.24.0"
def aspectJVersion = "1.9.20.1"

configurations {
    agent {
        canBeResolved = true
        canBeConsumed = true
    }
}

dependencies {
    testImplementation "org.testng:testng:$testngVersion"
    testImplementation "com.codeborne:selenide:$selenideVersion"
    testImplementation platform("io.qameta.allure:allure-bom:$allureVersion")
    testImplementation "io.qameta.allure:allure-testng"
    agent "org.aspectj:aspectjweaver:$aspectJVersion"
}

test {
    def groups = System.getProperty('groups.include') ?: null

    useTestNG {
        if (groups) {
            includeGroups groups
        }
        systemProperty "testng.listeners", "io.qameta.allure.testng.AllureTestNg"
    }

    testLogging {
        events "passed", "skipped", "failed"
    }

    jvmArgs = [ "-javaagent:${configurations.agent.singleFile}" ]
}